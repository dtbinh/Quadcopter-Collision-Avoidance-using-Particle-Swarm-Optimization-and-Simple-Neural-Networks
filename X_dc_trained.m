function [Y,Xf,Af] = X_dc_trained(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 01-Jul-2017 15:08:24.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx4 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-22.9773659469745;-23.2872499451714;-115.183413624127;-116.842498214888];
x1_step1.gain = [0.0435210895064181;0.0429419533158466;0.00868180555286594;0.00855852977536368];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.54842759831620047;0.84714452939587448;0.84976485381350186;0.63438095463887423;2.2773738588331014;2.4028225555126164;0.67810908026650396;-2.3594188320323979;4.3739630767335749;-0.51318347718348367;4.2994306381566121;1.8589084512257612;-0.32226851610247675;0.86090536080962388;1.2709586748878405;0.9535600359838815;-0.62455954728821661;0.52928855223449134;-0.47722512595585342;-0.52005884409562442;0.56203860247468029;1.9741487695371516;-0.44079043522950001;-0.25443570111640962;0.77524514188135507;1.9741504638248024;-0.3953289017858152;0.58290981786301921;0.84040099927779333;0.60542421857605166;-0.89513230608130345;-1.3356674677852829;0.40159994901135965;0.5960122527841123;0.73998298949404728;-0.70172719520323357;0.73779590637537906;1.92753377251467;-0.66405734125165017;0.66611353250682714;1.7844745108782909;0.4364487643541195;-1.2076230318942935;0.5754989515170309;1.3424757026558132;1.9554117950935754;-0.4697738465539717;1.2734772596081774;1.5648064702757543;2.4224086071247912];
IW1_1 = [2.303605660552114 -7.3499647437398421 -3.9206704178592124 -8.6461484690984243;-11.517115994881195 0.073681975419620668 -3.4992871671677017 0.508330578494399;-0.56076959785729896 17.465215801726988 4.5048416341641646 5.8835522269585487;-21.572081824666306 4.9212671759384614 -19.277724573137107 1.1115392176543044;-1.1761298428815918 -15.747052161214715 6.3811743083101495 -4.2234994588347021;-15.018611685646178 0.82331024347991288 -17.860711639806649 -1.0381683885532638;-12.61172297461345 -5.8304042791695521 -8.9173556134635739 -1.8460304146570428;-1.1941260965411429 23.452809919374136 -9.0181647230491766 11.25105805165564;0.69355392190314424 -3.814470541860369 1.9390316970958541 5.6495793027517296;6.0339952593797141 -13.456740934337885 5.0721475338947073 -17.329115587160196;-1.5570374321644822 2.8981058226008956 0.86941978437103229 -2.519401269510833;-1.0101772936956801 10.229918205629257 5.2201819195717087 1.7137018989261696;-10.293828247350966 3.9691323385682447 -11.337420588611737 3.9892762520990961;-6.5848601425298181 5.4193412201548012 -5.5484804725189614 5.4532264040710796;16.479656451126676 -1.183376315356218 10.85337328600923 1.2077036952629625;3.0093316366539118 9.4836846966613813 3.5128575797246731 9.291488687397722;14.11051785352819 -11.365084931755375 6.6976396437649504 -12.245769326958825;-12.420332557759238 -19.099926316054312 -3.8161049662097386 -22.134489949169378;15.099875000855896 -4.7087685836700937 14.879821074465928 -4.7836081793797085;0.1315184475559093 -2.7232624445292757 13.077442886699862 -2.8837970035214746;-12.426803420856844 -31.390435149332603 -5.8171850532205411 -28.451931225566376;0.76460129322066939 16.846931227136412 -5.9072124052951827 5.9374884411094193;17.267291711484287 -11.141582999179187 11.65852870686723 -7.608801178889796;9.1411243107738933 -3.9151801116096467 6.3364874119569263 0.022722534505060253;21.142522629282119 17.426977759850924 16.293544311361007 19.387806291613462;-0.28994935846592695 28.133189275702186 -7.0275462686753336 16.921612375799796;21.272946770857132 1.9331257695498112 22.499580259474108 8.6986654987727139;-17.525865824803176 -16.755853846691586 -8.3018730163271854 -19.972033427754763;3.8566472790118094 18.039983924795735 8.9541952081704608 6.5251031708453135;20.329575097532093 -7.1495575867442085 20.444507018619515 -2.7298140870689229;1.7422208862331277 1.7142492497169119 -5.8390646712152465 1.2116566383821434;2.6627320401767269 -4.6094431063096053 -0.24099349545662715 -0.68654609420063639;-8.8751913366884434 8.870121283648265 -3.7204920234660492 5.6045743547146269;-6.4874726230332422 17.335886141269345 -8.7546178775516914 9.1741810044482559;-10.405190216481476 0.057920032450218317 -7.0188994952707526 4.1849619786689383;-5.9069592102951338 -2.1465730277224946 -8.4336477948033508 0.99860976517774147;-16.832086511335984 10.727648794156117 -19.752595047952365 10.051883048774423;-2.3972972971353235 -0.4595184980279573 4.0901726092668609 8.9624475018814831;0.77432777180948154 -26.337691586158392 3.3105676667935144 -17.481010456542013;17.204534646656978 0.088083932397455156 0.75438127122496668 1.0152794333928272;7.431035643958408 -10.356483904227815 8.069347781974896 -3.5124806128708008;-7.8876754947710426 4.7049751385401422 -10.124347782977088 4.2007002158040594;-19.2210377480455 -4.3620621645539313 -19.587286118042332 -9.3062677494105994;9.8388835982739398 0.27767784302932075 -4.7765909723213245 0.75915084676392341;9.1863419995490272 5.8294487071923076 3.2716923519636594 8.1844027534909198;-0.25270759942058896 6.975527160400345 -6.8583984917947474 -3.6579215807129386;7.7484593027327087 22.200891532120519 2.0008832068038669 19.756920712807279;7.7340507217858772 15.568437119838167 1.8837719870985568 17.808728254454024;2.1569951870914275 -16.301244527521288 2.7949061648500413 -9.9457363453238106;-5.0972944956021582 -5.3550361924276073 -7.972195406781184 -7.1662510981029266];

% Layer 2
b2 = [-5.9128852432682892;1.9757861410328736];
LW2_1 = [6.9169676259422532 -9.5114326945153955 -5.9582042117213287 -4.702482380585252 9.954430950496894 -8.1777053904041814 -5.1924309721077719 6.3624520053904492 -0.44578159179439952 3.4163069435502051 -0.14560656112858431 1.1553805108059421 -9.2216357243848748 -10.984295134013477 6.8398296266777336 7.3281084139782529 -6.1994361547075227 -7.8512386052489553 -11.811712944679883 6.5098578872929913 -7.0869084854452673 14.313936540021514 6.9888402762821329 -7.0057753570869847 -4.1206654610731839 -6.5772666373406752 4.2221826378929252 6.7804749953365837 5.9251921286428573 -4.8269707652971041 -8.0396059996751816 -6.8983652748981212 7.8540009027109994 9.9808599258618624 6.9351471769358177 11.645401745798408 -7.5045424605912396 -4.8083990133280601 7.2387139395397977 -3.7273169439521054 -8.7296530640165901 13.569056318741273 -7.0167586611923154 9.5271975332191392 -12.590977079377081 -8.0934843757743931 -10.597066633897359 9.3833935489438787 7.7930243526672554 7.9510481323603885;-2.1284681625215551 3.6936936285539566 1.7064140546136453 1.1098285596807027 -2.8698225361576464 2.5038707893528915 1.4586255833939294 -2.0629358237504629 0.065156414177491725 -0.77547474584017151 0.17119240761565294 -0.089174984123190054 1.4759329731484232 2.2151841665855798 -0.81071254783164914 -3.7057775901819974 2.066036374975833 2.9007616317132863 2.7861825079001368 -1.7407190058446647 2.9820341045302174 -5.7931942139184827 -0.96106437362330011 1.1331802410227152 1.387181747129089 2.9633922678298639 -1.4910753163931203 -2.5288064243778514 -1.6497572718275433 1.5658558698202381 3.161078944684665 0.80466690824766718 -0.96023523318193693 -3.5433353833661703 -1.7458385408254014 -1.2658490938134781 4.4312792790513758 1.099649590459987 -2.5658734670649168 0.64796865628383937 2.0594782644641589 -6.5559355571143021 1.1594848375542093 -2.1722851523194331 1.1382670861113668 3.056899104571106 4.1917280591597779 -1.2344767509479679 -2.3406617431769745 -2.3077889106282359];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;3.81971863420549];
y1_step1.xoffset = [1;0];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
